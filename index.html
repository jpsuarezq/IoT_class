<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets Data</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="container">
        <h1 class="mt-5">Datos de Google Sheets</h1>
        <table id="data-table" class="table table-striped mt-3">
            <thead>
                <tr id="header-row">
                    <!-- Aquí irán los encabezados de la tabla -->
                </tr>
            </thead>
            <tbody id="data-body">
                <!-- Aquí irán los datos de la tabla -->
            </tbody>
        </table>
    </div>
    <script>
        function fetchData() {
            // Aquí debes reemplazar 'your-web-service-url' con la URL de tu servicio web
            fetch('https://script.google.com/macros/s/AKfycby3JXO_gHuaDXtmidxTXv9h3C5Ym2IVQUJBkMl20wNM4EZUc7C5R5TAY012_qZ6dTKauQ/exec')
                .then(response => response.json())
                .then(data => {
                    var headerRow = document.getElementById('header-row');
                    var dataBody = document.getElementById('data-body');
                    // Limpia la tabla antes de agregar nuevos datos
                    headerRow.innerHTML = '';
                    dataBody.innerHTML = '';
                    // Agrega los datos a la tabla
                    data.forEach((row, i) => {
                        var tr = document.createElement('tr');
                        row.forEach(cell => {
                            var td = document.createElement(i === 0 ? 'th' : 'td');
                            td.textContent = cell;
                            tr.appendChild(td);
                        });
                        if (i === 0) {
                            headerRow.appendChild(tr);
                        } else {
                            dataBody.appendChild(tr);
                        }
                    });
                })
                .catch(error => console.error('Error:', error));
        }
        // Llama a la función fetchData cada 2 segundos
        setInterval(fetchData, 2000);
    </script>
</body>
</html>
