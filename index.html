<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consulta de Google Sheets</title>
</head>
<body>
    <h1>Tabla de Datos de Google Sheets</h1>
    <table id="tablaDatos">
        <!-- Aquí se agregará la tabla dinámicamente -->
    </table>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Función para consultar el servicio web y actualizar la tabla
            function actualizarTabla() {
                fetch("https://script.google.com/macros/s/AKfycby3JXO_gHuaDXtmidxTXv9h3C5Ym2IVQUJBkMl20wNM4EZUc7C5R5TAY012_qZ6dTKauQ/exec")
                    .then(response => response.json())
                    .then(data => {
                        // Limpiar la tabla antes de actualizarla
                        document.getElementById("tablaDatos").innerHTML = "";

                        // Crear la cabecera de la tabla
                        let headerRow = document.createElement("tr");
                        for (let key in data[0]) {
                            let headerCell = document.createElement("th");
                            headerCell.textContent = key;
                            headerRow.appendChild(headerCell);
                        }
                        document.getElementById("tablaDatos").appendChild(headerRow);

                        // Crear las filas de datos
                        data.forEach(entry => {
                            let row = document.createElement("tr");
                            for (let key in entry) {
                                let cell = document.createElement("td");
                                cell.textContent = entry[key];
                                row.appendChild(cell);
                            }
                            document.getElementById("tablaDatos").appendChild(row);
                        });
                    })
                    .catch(error => console.error("Error al obtener datos:", error));
            }

            // Llamar a la función para actualizar la tabla cada medio segundo
            setInterval(actualizarTabla, 500);
        });
    </script>
</body>
</html>
